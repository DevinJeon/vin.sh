" setting for encoding
set encoding=utf-8
set fileencoding=utf-8
set fileencodings=ucs-bom,utf-8,cp949,latin1

syntax on " Enable highlighting syntax

set nocp " not compatible with `vi`
set hls " hightlight search keywords
set ruler " show current cursor location
set history=1000 " history of vim command

set expandtab " softtab(space)
set tabstop=4 " tab size
set sw=4 " tab size: shifting(`<<`, `>>`)
set sts=4 " tab size: shifting(`<<`, `>>`)
set autoindent
set backspace=indent,eol,start

" Plugins
call plug#begin('~/.vim/plugged')

Plug 'rhysd/committia.vim'
Plug 'hotwatermorning/auto-git-diff'
Plug 'dense-analysis/ale' " Asynchronous Lint Engine
Plug 'scrooloose/nerdtree', { 'on': 'NERDTreeToggle' }  " - NERDTree
Plug 'sheerun/vim-polyglot' " Highlight many languages syntax
Plug 'tpope/vim-commentary' " Add shortcut `gc[c]` to comment out
Plug 'eugen0329/vim-esearch' " Async search and replace
Plug 'Yggdroot/indentLine'
Plug 'wincent/command-t', {
    \   'do': 'cd ruby/command-t/ext/command-t && ruby extconf.rb && make'}
Plug 'fatih/vim-go', { 'do': ':GoUpdateBinaries' }
Plug 'fisadev/vim-isort'

" google/vimcodefmt
Plug 'google/vim-maktaba'
Plug 'google/vim-glaive'
Plug 'google/vim-codefmt'

" lsp
Plug 'prabirshrestha/vim-lsp'
Plug 'mattn/vim-lsp-settings'
Plug 'prabirshrestha/asyncomplete.vim'
Plug 'prabirshrestha/asyncomplete-lsp.vim'
call plug#end()

" =================
" google/vimcodefmt

autocmd FileType c,cpp,proto let b:codefmt_formatter='clang-format'
autocmd FileType vue,javascript,html,css,sass,scss,less,json let b:codefmt_formatter='prettier'
autocmd FileType python let b:codefmt_formatter='yapf'
autocmd FileType go let b:codefmt_formatter='gofmt'
autocmd FileType bash,sh,zsh let b:codefmt_formatter='shfmt'

" =================

" Code format
vnoremap <Leader>c :FormatLines<CR>:LspDocumentRangeFormat<CR>
noremap <Leader>fc :FormatCode<CR>:LspDocumentFormat<CR>

" Python isort
autocmd FileType python let g:vim_isort_map = '<C-i>'
autocmd FileType python map <C-i> :Isort<CR>
autocmd FileType python let g:vim_isort_python_version = 'python3'
autocmd FileType python vnoremap <Leader>c <C-i>:FormatLines<CR>:LspDocumentRangeFormat<CR>
autocmd FileType python noremap <Leader>fc :Isort<CR>:FormatCode<CR>:LspDocumentFormat<CR>

" lsp
inoremap <expr> <Tab>   pumvisible() ? "\<C-n>" : "\<Tab>"
inoremap <expr> <S-Tab> pumvisible() ? "\<C-p>" : "\<S-Tab>"
inoremap <expr> <cr>    pumvisible() ? "\<C-y>" : "\<cr>"

" indentLine
let g:indentLine_char = 'â”†'
let g:indentLine_color_term = 243
let g:indentLine_color_gui = '#767676'

" Custom
hi Search ctermbg=4 ctermfg=15
map <Leader>p :set paste<CR>
map <Leader><S-p> :set nopaste<CR>
map <C-j> <C-w>j
map <C-k> <C-w>k
